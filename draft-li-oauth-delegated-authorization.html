<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OAuth 2.0 Delegated Authorization</title>
<meta content="Ruochen Li" name="author">
<meta content="Haiguang Wang" name="author">
<meta content="Chunchi Peter Liu" name="author">
<meta content="Tieyan Li" name="author">
<meta content="
       Delegated authorization enables a client to delegate a subset of its granted privileges to a subordinate access token (also known as a delegated access token). This mechanism allows the client to securely delegate authorization to a delegated party while maintaining fine-grained control over delegated permissions. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="draft-li-oauth-delegated-authorization-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-li-oauth-delegated-authorization.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Delegated-Auth</td>
<td class="right">November 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Li, et al.</td>
<td class="center">Expires 15 May 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">oauth</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-li-oauth-delegated-authorization-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-11-11" class="published">11 November 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-05-15">15 May 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Li</div>
<div class="org">Huawei Int. Pte Ltd</div>
</div>
<div class="author">
      <div class="author-name">H. Wang</div>
<div class="org">Huawei Int. Pte Ltd</div>
</div>
<div class="author">
      <div class="author-name">C. Liu</div>
<div class="org">Huawei Technologies</div>
</div>
<div class="author">
      <div class="author-name">T. Li</div>
<div class="org">Huawei Int. Pte Ltd</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OAuth 2.0 Delegated Authorization</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Delegated authorization enables a client to delegate a subset of its granted privileges to a subordinate access token (also known as a delegated access token). This mechanism allows the client to securely delegate authorization to a delegated party while maintaining fine-grained control over delegated permissions.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://liuchunchi.github.io/li-oauth-delegated-authorization/draft-li-oauth-delegated-authorization.html">https://liuchunchi.github.io/li-oauth-delegated-authorization/draft-li-oauth-delegated-authorization.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-li-oauth-delegated-authorization/">https://datatracker.ietf.org/doc/draft-li-oauth-delegated-authorization/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        WG Working Group mailing list (<span><a href="mailto:oauth@ietf.org">mailto:oauth@ietf.org</a></span>),
        which is archived at <span><a href="https://datatracker.ietf.org/wg/oauth/about/">https://datatracker.ietf.org/wg/oauth/about/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/oauth/">https://www.ietf.org/mailman/listinfo/oauth/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/liuchunchi/li-oauth-delegated-authorization">https://github.com/liuchunchi/li-oauth-delegated-authorization</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 15 May 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-delegated-party-metadata" class="internal xref">Delegated Party Metadata</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-delegated-party-metadata-at" class="internal xref">Delegated Party Metadata Attributes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-delegated-party-metadata-ex" class="internal xref">Delegated Party Metadata Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-www-authenticate" class="internal xref">WWW-Authenticate</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-acquiring-delegation-tokens" class="internal xref">Acquiring Delegation Tokens</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-authorization-code-grant" class="internal xref">Authorization Code Grant</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-other-grant-types" class="internal xref">Other Grant Types</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-creating-delegated-access-t" class="internal xref">Creating Delegated Access Tokens</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-using-delegated-access-toke" class="internal xref">Using Delegated Access Tokens</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-verification-of-delegated-a" class="internal xref">Verification of Delegated Access Tokens</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-local-verification" class="internal xref">Local Verification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-token-introspection" class="internal xref">Token Introspection</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-operational-considerations" class="internal xref">Operational Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-well-known-uris-registry" class="internal xref">Well-Known URIs Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-oauth-parameters-registry" class="internal xref">OAuth Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-oauth-access-token-types-re" class="internal xref">OAuth Access Token Types Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-http-field-name-registry" class="internal xref">HTTP Field Name Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="auto internal xref">12.5</a>.  <a href="#name-oauth-delegated-party-metad" class="internal xref">OAuth Delegated Party Metadata Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5.2.1">
                    <p id="section-toc.1-1.12.2.5.2.1.1"><a href="#section-12.5.1" class="auto internal xref">12.5.1</a>.  <a href="#name-registration-template" class="internal xref">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5.2.2">
                    <p id="section-toc.1-1.12.2.5.2.2.1"><a href="#section-12.5.2" class="auto internal xref">12.5.2</a>.  <a href="#name-initial-registry-contents" class="internal xref">Initial Registry Contents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-token-format" class="internal xref">Token Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-example-1" class="internal xref">Example 1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-example-2" class="internal xref">Example 2</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-delegating-subset-of-access" class="internal xref">Delegating Subset of Access Rights to Specialized AI Agents</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-thirdparty-analytics-platfo" class="internal xref">Third‑Party Analytics Platform Integrated in an Enterprise SaaS</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> provides a framework for authorizing third-party applications to access protected resources on behalf of a resource owner. However, in existing implementations, access tokens issued to clients often contain excessive permissions that exceed actual requirements, creating security vulnerabilities and potential data exposure risks.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This specification extends OAuth 2.0 with a delegated authorization framework that enables clients to create subordinate access tokens with restricted permissions. This approach addresses the problem of over-privileged access tokens by implementing a two-token architecture that decouples initial authorization from final resource access.<a href="#section-1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requirements-language">
<section id="section-2">
      <h2 id="name-requirements-language">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">This specification uses the following terms defined in OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>: authorization server, client, resource server, and resource owner.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The following additional terms are used throughout this document:<a href="#section-3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-3">
        <dt id="section-3-3.1">
<strong>Delegated Party (DP)</strong>:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.2">
          <p id="section-3-3.2.1">An entity (e.g., a service, component, or application) authorized by the client to access protected resources on behalf of the resource owner.<a href="#section-3-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.3">
<strong>Delegated Resource</strong>:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.4">
          <p id="section-3-3.4.1">A resource or API endpoint hosted by the delegated party that requires access to the resource owner’s protected data at a target resource server.<a href="#section-3-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.5">
<strong>Delegation Token</strong>:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.6">
          <p id="section-3-3.6.1">A token issued by the authorization server for the client that enables the client to create delegated access tokens.<a href="#section-3-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.7">
<strong>Delegated Access Token</strong>:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.8">
          <p id="section-3-3.8.1">A token created by the client using the delegation token, with permissions being a subset of the delegation token's privileges and a more limited lifespan.<a href="#section-3-3.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.9">
<strong>Delegation Key</strong>:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.10">
          <p id="section-3-3.10.1">A cryptographic key bound to the delegation token, used by the client to sign or encrypt delegated access tokens. The delegation key is presented in the token request as the <code>delegation_key</code> parameter.<a href="#section-3-3.10.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="overview">
<section id="section-4">
      <h2 id="name-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-4-1">The delegated authorization framework introduces a hierarchical token structure where a client can obtain a delegation token from an authorization server and use it to issue subordinate access tokens with reduced permissions. This enables fine-grained access control while maintaining the security properties of the original authorization grant.<a href="#section-4-1" class="pilcrow">¶</a></p>
<span id="name-delegated-authorization-fra"></span><div id="fig-architecture">
<figure id="figure-1">
        <div id="section-4-2.1">
          <div class="alignCenter art-svg artwork" id="section-4-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="496" width="512" viewBox="0 0 512 496" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 96,32 L 96,288" fill="none" stroke="black"></path>
              <path d="M 96,368 L 96,480" fill="none" stroke="black"></path>
              <path d="M 120,288 L 120,368" fill="none" stroke="black"></path>
              <path d="M 168,288 L 168,368" fill="none" stroke="black"></path>
              <path d="M 192,32 L 192,112" fill="none" stroke="black"></path>
              <path d="M 192,144 L 192,256" fill="none" stroke="black"></path>
              <path d="M 192,368 L 192,448" fill="none" stroke="black"></path>
              <path d="M 376,32 L 376,48" fill="none" stroke="black"></path>
              <path d="M 376,80 L 376,144" fill="none" stroke="black"></path>
              <path d="M 376,176 L 376,192" fill="none" stroke="black"></path>
              <path d="M 376,224 L 376,288" fill="none" stroke="black"></path>
              <path d="M 376,368 L 376,384" fill="none" stroke="black"></path>
              <path d="M 376,416 L 376,480" fill="none" stroke="black"></path>
              <path d="M 504,32 L 504,144" fill="none" stroke="black"></path>
              <path d="M 504,176 L 504,288" fill="none" stroke="black"></path>
              <path d="M 504,368 L 504,480" fill="none" stroke="black"></path>
              <path d="M 96,32 L 192,32" fill="none" stroke="black"></path>
              <path d="M 376,32 L 504,32" fill="none" stroke="black"></path>
              <path d="M 192,64 L 376,64" fill="none" stroke="black"></path>
              <path d="M 192,128 L 376,128" fill="none" stroke="black"></path>
              <path d="M 376,144 L 504,144" fill="none" stroke="black"></path>
              <path d="M 376,176 L 504,176" fill="none" stroke="black"></path>
              <path d="M 192,208 L 376,208" fill="none" stroke="black"></path>
              <path d="M 192,272 L 376,272" fill="none" stroke="black"></path>
              <path d="M 96,288 L 112,288" fill="none" stroke="black"></path>
              <path d="M 128,288 L 192,288" fill="none" stroke="black"></path>
              <path d="M 376,288 L 504,288" fill="none" stroke="black"></path>
              <path d="M 96,368 L 160,368" fill="none" stroke="black"></path>
              <path d="M 176,368 L 192,368" fill="none" stroke="black"></path>
              <path d="M 376,368 L 504,368" fill="none" stroke="black"></path>
              <path d="M 192,400 L 376,400" fill="none" stroke="black"></path>
              <path d="M 192,464 L 376,464" fill="none" stroke="black"></path>
              <path d="M 96,480 L 192,480" fill="none" stroke="black"></path>
              <path d="M 376,480 L 504,480" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="384,400 372,394.4 372,405.6" fill="black" transform="rotate(0,376,400)"></polygon>
              <polygon class="arrowhead" points="384,208 372,202.4 372,213.6" fill="black" transform="rotate(0,376,208)"></polygon>
              <polygon class="arrowhead" points="384,64 372,58.4 372,69.6" fill="black" transform="rotate(0,376,64)"></polygon>
              <polygon class="arrowhead" points="200,464 188,458.4 188,469.6" fill="black" transform="rotate(180,192,464)"></polygon>
              <polygon class="arrowhead" points="200,272 188,266.4 188,277.6" fill="black" transform="rotate(180,192,272)"></polygon>
              <polygon class="arrowhead" points="200,128 188,122.4 188,133.6" fill="black" transform="rotate(180,192,128)"></polygon>
              <polygon class="arrowhead" points="176,368 164,362.4 164,373.6" fill="black" transform="rotate(90,168,368)"></polygon>
              <polygon class="arrowhead" points="128,288 116,282.4 116,293.6" fill="black" transform="rotate(270,120,288)"></polygon>
              <g class="text">
                <text x="212" y="36">1.</text>
                <text x="280" y="36">Authorization</text>
                <text x="272" y="52">Request</text>
                <text x="436" y="84">Resource</text>
                <text x="212" y="100">2.</text>
                <text x="280" y="100">Authorization</text>
                <text x="440" y="100">Owner</text>
                <text x="264" y="116">Grant</text>
                <text x="140" y="164">Client</text>
                <text x="212" y="180">3.</text>
                <text x="280" y="180">Authorization</text>
                <text x="264" y="196">Grant</text>
                <text x="440" y="228">Authorization</text>
                <text x="212" y="244">4.</text>
                <text x="268" y="244">Delegation</text>
                <text x="444" y="244">Server</text>
                <text x="264" y="260">Token</text>
                <text x="180" y="308">5.</text>
                <text x="232" y="308">Delegated</text>
                <text x="12" y="324">6.</text>
                <text x="64" y="324">Delegated</text>
                <text x="236" y="324">Access</text>
                <text x="84" y="340">Resource</text>
                <text x="232" y="340">Token</text>
                <text x="212" y="372">5.</text>
                <text x="264" y="372">Delegated</text>
                <text x="268" y="388">Access</text>
                <text x="320" y="388">Token</text>
                <text x="144" y="420">Delegated</text>
                <text x="436" y="420">Resource</text>
                <text x="144" y="436">Party</text>
                <text x="212" y="436">6.</text>
                <text x="264" y="436">Protected</text>
                <text x="436" y="436">Server</text>
                <text x="276" y="452">Resource</text>
              </g>
            </svg><a href="#section-4-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-delegated-authorization-fra" class="selfRef">Delegated Authorization Framework Architecture</a>
        </figcaption></figure>
</div>
<ol start="1" type="1" class="normal type-1" id="section-4-3">
<li id="section-4-3.1">
          <p id="section-4-3.1.1">The client requests authorization from the resource owner. The client indicates in the authorization request that the requested authorization grant is for delegated authorization.<a href="#section-4-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-3.2">
          <p id="section-4-3.2.1">The client receives an authorization grant.<a href="#section-4-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-3.3">
          <p id="section-4-3.3.1">The client requests a delegation token by authenticating with the authorization server and presenting the authorization grant and its delegation key as defined in Section 3.<a href="#section-4-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-3.4">
          <p id="section-4-3.4.1">The authorization server authenticates the client and validates the authorization grant, and if valid, issues a delegation token.<a href="#section-4-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-3.5">
          <p id="section-4-3.5.1">The client calls the delegated party's API, presenting the delegated access token generated from the delegation token. The delegated access token is issued by the client using the delegation key. The delegated party requests the target protected resource from the resource server and presents the delegated access token.<a href="#section-4-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-3.6">
          <p id="section-4-3.6.1">The resource server validates the delegated access token, and if valid, serves the resource. The delegated party receives the resource, optionally transforms it into a service-specific response (also known as delegated resource), and returns it to the client.<a href="#section-4-3.6.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-4-4">Both delegation token and delegated access token can be JSON Web Tokens (JWTs) <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> or CBOR Web Tokens (CWTs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="delegated-party-metadata">
<section id="section-5">
      <h2 id="name-delegated-party-metadata">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-delegated-party-metadata" class="section-name selfRef">Delegated Party Metadata</a>
      </h2>
<p id="section-5-1">Before the OAuth 2.0 client retrieves a delegation token and generates a delegated access token for the delegated party, the client needs to obtain the authorization server endpoint and the permissions needed by the delegated party. Such information can be manually configured into the client, or it can be dynamically discovered through delegated party metadata.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Delegated party metadata enables OAuth 2.0 clients to obtain information needed to interact with a delegated party. The structure of the metadata format is similar to "OAuth 2.0 Authorization Server Metadata" <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> and "OAuth 2.0 Protected Resource Metadata" <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The delegated party metadata is retrieved from a well-known <span>[<a href="#RFC8615" class="cite xref">RFC8615</a>]</span> location as a JSON <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> document. By default, the well-known URI string used is <code>/.well-known/oauth-delegated-party</code>.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="delegated-party-metadata-attributes">
<section id="section-5.1">
        <h3 id="name-delegated-party-metadata-at">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-delegated-party-metadata-at" class="section-name selfRef">Delegated Party Metadata Attributes</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-5.1-1">
          <dt id="section-5.1-1.1">
<strong>resources</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-1.2">
            <p id="section-5.1-1.2.1"><strong><span class="bcp14">RECOMMENDED</span></strong>. JSON array containing a list of target protected resources' resource identifiers, as defined in <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>. Either this attribute or <strong>authorization_servers</strong> defined below <span class="bcp14">MUST</span> be present.<a href="#section-5.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-1.3">
<strong>authorization_servers</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-1.4">
            <p id="section-5.1-1.4.1"><strong><span class="bcp14">OPTIONAL</span></strong>. JSON array containing a list of OAuth authorization server issuer identifiers, as defined in <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>. Either this attribute or <strong>resources</strong> defined above <span class="bcp14">MUST</span> be present.<a href="#section-5.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-1.5">
<strong>permissions_supported</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-1.6">
            <p id="section-5.1-1.6.1"><strong><span class="bcp14">RECOMMENDED</span></strong>. JSON object indicating the permissions the delegated party may request. The <code>scopes</code> attribute lists supported scope values <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>; the <code>authorization_details</code> attribute lists supported rich authorization request objects as defined in <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span>. These guide the client in constructing valid authorization and token requests. Either the <code>scopes</code> attribute or the <code>authorization_details</code> attribute must be present.<a href="#section-5.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-1.7">
<strong>api_permissions</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-1.8">
            <p id="section-5.1-1.8.1"><strong><span class="bcp14">RECOMMENDED</span></strong>. JSON object mapping API endpoints (resource identifiers) to the permissions required to access them. Each value can include <code>scopes</code> and/or <code>authorization_details</code> to specify the permissions needed for that endpoint/resource.<a href="#section-5.1-1.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-1.9">
<strong>delegated_party_documentation</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-1.10">
            <p id="section-5.1-1.10.1"><strong><span class="bcp14">OPTIONAL</span></strong>: URL of a page containing human-readable information that developers might want or need to know when using the delegated party. The value of this field <span class="bcp14">MAY</span> be internationalized.<a href="#section-5.1-1.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="delegated-party-metadata-example">
<section id="section-5.2">
        <h3 id="name-delegated-party-metadata-ex">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-delegated-party-metadata-ex" class="section-name selfRef">Delegated Party Metadata Example</a>
        </h3>
<p id="section-5.2-1">The following is a non-normative example delegated party metadata:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="breakable lang-sourcecode sourcecode" id="section-5.2-2">
<pre>
{
  "resources": [
    "https://res1.example.com",
    "https://res2.example.net"
  ],
  "authorization_servers": [
    "https://as1.example.com",
    "https://as2.example.net"
  ],
  "permissions_supported": {
    "scopes": ["profile:read", "profile:write", "email:read", "email:write"],
    "authorization_details": [
      {
        "type": "payment",
        "actions": ["initiate", "status", "cancel"],
        "instructedAmount": {
          "notMoreThan": {
            "currency": "USD",
            "amount": "500.00"
          }
        }
      }
    ]
  },
  "api_permissions": {
    "/emails/list": {
      "scopes": ["email:read"]
    },
    "/balance/transfer": {
      "authorization_details": [
        {
          "type": "payment",
          "actions": ["initiate"],
          "instructedAmount": {
            "notMoreThan": {
              "currency": "USD",
              "amount": "500.00"
            }
          }
        }
      ]
    },
    "/balance/transfer/status": {
      "authorization_details": [
        {
          "type": "payment",
          "actions": ["status"]
        }
      ]
    },
    "/balance/transfer/cancel": {
      "authorization_details": [
        {
          "type": "payment",
          "actions": ["cancel"]
        }
      ]
    }
  },
  "delegated_party_documentation": "https://dp.example.com/dp_documentation.html"
}
</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="www-authenticate">
<section id="section-5.3">
        <h3 id="name-www-authenticate">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-www-authenticate" class="section-name selfRef">WWW-Authenticate</a>
        </h3>
<p id="section-5.3-1">Upon receipt of a request for a delegated resource that lacks credentials, the delegated party can reply with a challenge using the 401 (Unauthorized) status code (<span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> Section 15.5.2) and the <code>WWW-Authenticate</code> header field (<span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> Section 11.6.1).<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">This specification introduces a new parameter in the <code>WWW-Authenticate</code> HTTP response header field to indicate the delegated party metadata URL:<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3-3">
          <dt id="section-5.3-3.1">
<strong>delegated_party_metadata</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-5.3-3.2">
            <p id="section-5.3-3.2.1">The URL of the delegated party metadata.<a href="#section-5.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.3-4">The response below is an example of a <code>WWW-Authenticate</code> header that includes the delegated party metadata URL. NOTE: '\' line wrapping per <span>[<a href="#RFC8792" class="cite xref">RFC8792</a>]</span>.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-5">
<pre>
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer delegated_party_metadata=\
  "https://dp.example.com/.well-known/oauth-delegated-party"
</pre><a href="#section-5.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acquiring-delegation-tokens">
<section id="section-6">
      <h2 id="name-acquiring-delegation-tokens">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-acquiring-delegation-tokens" class="section-name selfRef">Acquiring Delegation Tokens</a>
      </h2>
<p id="section-6-1">The client requests a delegation token using standard OAuth 2.0 grant types with additional parameters to distinguish delegation requests from standard token requests.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="authorization-code-grant">
<section id="section-6.1">
        <h3 id="name-authorization-code-grant">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-authorization-code-grant" class="section-name selfRef">Authorization Code Grant</a>
        </h3>
<p id="section-6.1-1">For authorization code grant type, the client <span class="bcp14">MUST</span> include a <code>delegation=true</code> parameter in the authorization request to indicate that the client is requesting a delegation token instead of an OAuth 2.0 access token.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Additionally, the authorization request <span class="bcp14">MUST</span> include either a <code>scope</code> parameter (as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> Section 3.3), an <code>authorization_details</code> parameter (as defined in "Rich Authorization Requests" <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span>), or both, that define the permissions granted to the requested delegation token.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">In the token request, the client <span class="bcp14">MUST</span> include a <code>delegation_key</code> parameter with the value of the delegation key. This is normally a public key for digital signature. It can be extended to support encryption public keys, or secret keys for MAC or symmetric encryption.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">Additionally, the client <span class="bcp14">MAY</span> include in the token request either a <code>scope</code> parameter, an <code>authorization_details</code> parameter, or both. The client <span class="bcp14">MAY</span> also include a <code>delegation=true</code> parameter in the token request.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">In the token response, the authorization server <span class="bcp14">MUST</span> include an <code>access_token</code> attribute whose value is the delegation token, and <span class="bcp14">MUST</span> include a <code>token_type</code> attribute valued <code>"Delegation"</code>, and <span class="bcp14">MAY</span> include a <code>refresh_token</code> attribute which is the refresh token for obtaining a new delegation token via the refresh token grant.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">Other procedures of the authorization code grant are as described in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. Use of Proof Key for Code Exchange (PKCE) <span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span> is <span class="bcp14">RECOMMENDED</span>.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-grant-types">
<section id="section-6.2">
        <h3 id="name-other-grant-types">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-other-grant-types" class="section-name selfRef">Other Grant Types</a>
        </h3>
<p id="section-6.2-1">Other OAuth 2.0 grant types, such as the refresh token grant or client credentials grant, <span class="bcp14">MAY</span> support delegated authorization by including the <code>delegation</code> and <code>delegation_key</code> parameters when applicable. The authorization server <span class="bcp14">MUST</span> validate that the client is authorized to request delegation tokens using the given grant type.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="creating-delegated-access-tokens">
<section id="section-7">
      <h2 id="name-creating-delegated-access-t">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-creating-delegated-access-t" class="section-name selfRef">Creating Delegated Access Tokens</a>
      </h2>
<p id="section-7-1">The client creates delegated access tokens by:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-2">
<li id="section-7-2.1">
          <p id="section-7-2.1.1">Validating the delegation token's validity and permissions.<a href="#section-7-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-2.2">
          <p id="section-7-2.2.1">Generating a subordinate access token with (optionally) reduced privileges.<a href="#section-7-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-2.3">
          <p id="section-7-2.3.1">Applying cryptographic protection using the delegation key (digital signature, encryption or MAC).<a href="#section-7-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-7-3">The client <span class="bcp14">MUST</span> include the delegation token in the <code>delegation_token</code> attribute of the delegated access token.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">The client <span class="bcp14">MUST</span> ensure that the delegated access token's scope, lifetime, audience, and other claims do not exceed those of the delegation token. The client <span class="bcp14">MAY</span> generate single-use delegated access tokens that the resource server or authorization server only consider valid when validating it for the first time.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">The client is <span class="bcp14">RECOMMENDED</span> to "sender-constrain" the delegated access tokens by binding the delegated access tokens with public keys or certificates where the corresponding private keys are owned by the delegated parties, via techniques similar to OAuth 2.0 mTLS <span>[<a href="#RFC8705" class="cite xref">RFC8705</a>]</span> or OAuth 2.0 DPoP <span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>.<a href="#section-7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="using-delegated-access-tokens">
<section id="section-8">
      <h2 id="name-using-delegated-access-toke">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-using-delegated-access-toke" class="section-name selfRef">Using Delegated Access Tokens</a>
      </h2>
<p id="section-8-1">When the client accesses a delegated resource on the delegated party, the client <span class="bcp14">MUST</span> include the delegated access token as a bearer token <span>[<a href="#RFC6750" class="cite xref">RFC6750</a>]</span> in the <code>Delegated-Authorization</code> header, used by the target resource server to verify requests from the delegated party. The <code>Delegated-Authorization</code> header <span class="bcp14">MAY</span> be used in combination with an <code>Authorization</code> header used by the delegated party to verify the request from the client.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">For example:<a href="#section-8-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-3">
<pre>
GET /dp-resource HTTP/1.1
Host: delegated-party.example.com
Authorization: Bearer mF_9.B5g1234
Delegated-Authorization: Bearer mF_9.B5f-4.1JqM
</pre><a href="#section-8-3" class="pilcrow">¶</a>
</div>
<p id="section-8-4">Upon receiving a delegated resource request with a <code>Delegated-Authorization</code> header, the delegated party sends a request to the target resource server for the respective target resource. The delegated party <span class="bcp14">MUST</span> include the received delegated access token as a bearer token in the <code>Authorization</code> header.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">For example:<a href="#section-8-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-6">
<pre>
GET /target-resource HTTP/1.1
Host: resource.example.com
Authorization: Bearer mF_9.B5f-4.1JqM
</pre><a href="#section-8-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="verification-of-delegated-access-tokens">
<section id="section-9">
      <h2 id="name-verification-of-delegated-a">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-verification-of-delegated-a" class="section-name selfRef">Verification of Delegated Access Tokens</a>
      </h2>
<p id="section-9-1">Resource servers verify delegated access tokens through either local validation using pre-configured public keys or remote validation via token introspection <span>[<a href="#RFC7662" class="cite xref">RFC7662</a>]</span> at the authorization server.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="local-verification">
<section id="section-9.1">
        <h3 id="name-local-verification">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-local-verification" class="section-name selfRef">Local Verification</a>
        </h3>
<p id="section-9.1-1">The resource server verifies delegated access tokens by:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.1-2">
<li id="section-9.1-2.1">
            <p id="section-9.1-2.1.1">The resource server is pre-configured with the authorization server's public key, or it fetches the public key via the authorization server's JWKS endpoint <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.<a href="#section-9.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.1-2.2">
            <p id="section-9.1-2.2.1">Checking the digital signature of the delegation token (part of the delegated access token) against the authorization server's public key.<a href="#section-9.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.1-2.3">
            <p id="section-9.1-2.3.1">Checking the digital signature of the delegated access token against the delegation key bound to the delegation token.<a href="#section-9.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.1-2.4">
            <p id="section-9.1-2.4.1">Verifying the delegated access token's permissions and validity are within the scope of the delegation token.<a href="#section-9.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.1-2.5">
            <p id="section-9.1-2.5.1">Verifying the delegated access token is within validity period, and the delegated access token's permissions cover the resource request.<a href="#section-9.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="token-introspection">
<section id="section-9.2">
        <h3 id="name-token-introspection">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-token-introspection" class="section-name selfRef">Token Introspection</a>
        </h3>
<p id="section-9.2-1">The resource server sends the delegated access token to the authorization server via the token introspection endpoint. The authorization server verifies the delegated access token against its keys.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">This specification extends OAuth 2.0 to support delegated authorization through hierarchical token issuance. While this enables fine-grained privilege delegation, it also introduces new trust and security considerations.<a href="#section-10-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-2.1">
          <p id="section-10-2.1.1">Delegation tokens <span class="bcp14">MUST NOT</span> be sent to resource servers without subordinate delegated access tokens. Resource servers and authorization servers <span class="bcp14">MUST NOT</span> treat delegation tokens as regular OAuth access tokens.<a href="#section-10-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-2.2">
          <p id="section-10-2.2.1">Clients <span class="bcp14">MUST</span> protect the delegation key, as compromise allows an attacker to mint valid delegated access tokens within the scope of the delegation token.<a href="#section-10-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-2.3">
          <p id="section-10-2.3.1">Delegated access tokens <span class="bcp14">SHOULD</span> have short lifetimes and be bound to specific audiences, methods, and sender keys (e.g., via DPoP or mTLS) to mitigate replay and token leakage risks. Resource servers <span class="bcp14">MUST</span> validate both the delegation token and the delegated access token, ensuring the latter does not exceed the former’s permissions.<a href="#section-10-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-2.4">
          <p id="section-10-2.4.1">Token introspection CAN be used in scenarios where the tokens are kept opaque from the delegated party and the resource server. If employed, token introspection responses <span class="bcp14">MUST NOT</span> reveal sensitive internal information. Authorization servers <span class="bcp14">SHOULD</span> enforce rate limiting and audit token issuance and validation activities.<a href="#section-10-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="operational-considerations">
<section id="section-11">
      <h2 id="name-operational-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
      </h2>
<p id="section-11-1">Deployments of this specification should consider the following operational aspects:<a href="#section-11-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-2.1">
          <p id="section-11-2.1.1"><strong>Key Management</strong>: Clients <span class="bcp14">MUST</span> securely store and rotate delegation keys. Authorization servers <span class="bcp14">SHOULD</span> support key rotation for delegation tokens and provide mechanisms to revoke compromised keys.<a href="#section-11-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.2">
          <p id="section-11-2.2.1"><strong>Token Lifetimes</strong>: Delegation tokens <span class="bcp14">SHOULD</span> have longer lifetimes than delegated access tokens to reduce authorization server load, and <span class="bcp14">SHOULD</span> be refreshable using refresh tokens.<a href="#section-11-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.3">
          <p id="section-11-2.3.1"><strong>Metadata Caching</strong>: Delegated party metadata at the well-known URI /.well-known/oauth-delegated-party can be cached by clients; a reasonable default TTL (e.g., 24 hours) is <span class="bcp14">RECOMMENDED</span>.<a href="#section-11-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.4">
          <p id="section-11-2.4.1"><strong>Error Handling</strong>: Delegated parties and resource servers <span class="bcp14">SHOULD</span> provide clear error responses (e.g., invalid token, insufficient scope) without exposing implementation details.<a href="#section-11-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.5">
          <p id="section-11-2.5.1"><strong>Interoperability</strong>: Implementers <span class="bcp14">SHOULD</span> ensure compatibility with existing OAuth 2.0 features such as PKCE, Rich Authorization Requests, and sender-constrained tokens.<a href="#section-11-2.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="iana-considerations">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="well-known-uris-registry">
<section id="section-12.1">
        <h3 id="name-well-known-uris-registry">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-well-known-uris-registry" class="section-name selfRef">Well-Known URIs Registry</a>
        </h3>
<p id="section-12.1-1">This specification registers the following entry in the "Well-Known URIs" registry:<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-2.1">
            <p id="section-12.1-2.1.1"><strong>URI suffix</strong>: oauth-delegated-party<a href="#section-12.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-2.2">
            <p id="section-12.1-2.2.1"><strong>Reference</strong>: [this document]<a href="#section-12.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-2.3">
            <p id="section-12.1-2.3.1"><strong>Status</strong>: permanent<a href="#section-12.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-2.4">
            <p id="section-12.1-2.4.1"><strong>Change controller</strong>: IETF<a href="#section-12.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-2.5">
            <p id="section-12.1-2.5.1"><strong>Related information</strong>: (none)<a href="#section-12.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="oauth-parameters-registry">
<section id="section-12.2">
        <h3 id="name-oauth-parameters-registry">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-oauth-parameters-registry" class="section-name selfRef">OAuth Parameters Registry</a>
        </h3>
<p id="section-12.2-1">This specification registers the following parameters in the "OAuth Parameters" registry:<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2-2"><strong>Delegation:</strong><a href="#section-12.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-3.1">
            <p id="section-12.2-3.1.1"><strong>Name</strong>: delegation<a href="#section-12.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-3.2">
            <p id="section-12.2-3.2.1"><strong>Parameter Usage Location</strong>: authorization request, token request<a href="#section-12.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-3.3">
            <p id="section-12.2-3.3.1"><strong>Change Controller</strong>: IETF<a href="#section-12.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-3.4">
            <p id="section-12.2-3.4.1"><strong>Reference</strong>: [this document]<a href="#section-12.2-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-12.2-4"><strong>Delegation Key:</strong><a href="#section-12.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-5.1">
            <p id="section-12.2-5.1.1"><strong>Name</strong>: delegation_key<a href="#section-12.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-5.2">
            <p id="section-12.2-5.2.1"><strong>Parameter Usage Location</strong>: token request<a href="#section-12.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-5.3">
            <p id="section-12.2-5.3.1"><strong>Change Controller</strong>: IETF<a href="#section-12.2-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-5.4">
            <p id="section-12.2-5.4.1"><strong>Reference</strong>: [this document]<a href="#section-12.2-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="oauth-access-token-types-registry">
<section id="section-12.3">
        <h3 id="name-oauth-access-token-types-re">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-oauth-access-token-types-re" class="section-name selfRef">OAuth Access Token Types Registry</a>
        </h3>
<p id="section-12.3-1">This specification registers the following parameters in the "OAuth Access Token Types" registry:<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.3-2.1">
            <p id="section-12.3-2.1.1"><strong>Name</strong>: Delegation<a href="#section-12.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.2">
            <p id="section-12.3-2.2.1"><strong>Additional Token Endpoint Response Parameters</strong>: (none)<a href="#section-12.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.3">
            <p id="section-12.3-2.3.1"><strong>HTTP Authentication Scheme(s)</strong>: Bearer<a href="#section-12.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.4">
            <p id="section-12.3-2.4.1"><strong>Change Controller</strong>: IETF<a href="#section-12.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.5">
            <p id="section-12.3-2.5.1"><strong>Reference</strong>: [this document]<a href="#section-12.3-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="http-field-name-registry">
<section id="section-12.4">
        <h3 id="name-http-field-name-registry">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-http-field-name-registry" class="section-name selfRef">HTTP Field Name Registry</a>
        </h3>
<p id="section-12.4-1">This specification registers the following parameters in the "Hypertext Transfer Protocol (HTTP) Field Name" registry:<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.4-2.1">
            <p id="section-12.4-2.1.1"><strong>Field Name</strong>: Delegated-Authorization<a href="#section-12.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.4-2.2">
            <p id="section-12.4-2.2.1"><strong>Status</strong>: permanent<a href="#section-12.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.4-2.3">
            <p id="section-12.4-2.3.1"><strong>Structured Type</strong>: (none)<a href="#section-12.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.4-2.4">
            <p id="section-12.4-2.4.1"><strong>Reference</strong>: [this document]<a href="#section-12.4-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="oauth-delegated-party-metadata-registry">
<section id="section-12.5">
        <h3 id="name-oauth-delegated-party-metad">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-oauth-delegated-party-metad" class="section-name selfRef">OAuth Delegated Party Metadata Registry</a>
        </h3>
<p id="section-12.5-1">This specification establishes the "OAuth Delegated Party Metadata" registry for OAuth 2.0 dalagated party metadata names. The registry records the dalagated party metadata parameter and a reference to the specification that defines it.<a href="#section-12.5-1" class="pilcrow">¶</a></p>
<div id="registration-template">
<section id="section-12.5.1">
          <h4 id="name-registration-template">
<a href="#section-12.5.1" class="section-number selfRef">12.5.1. </a><a href="#name-registration-template" class="section-name selfRef">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-12.5.1-1">
            <dt id="section-12.5.1-1.1">
<strong>Metadata Name</strong>:</dt>
            <dd style="margin-left: 1.5em" id="section-12.5.1-1.2">
              <p id="section-12.5.1-1.2.1">The name requested (e.g., "resource"). This name is case sensitive. Names may not match other registered names in a case-insensitive manner unless the designated experts state that there is a compelling reason to allow an exception.<a href="#section-12.5.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.5.1-1.3">
<strong>Metadata Description</strong>:</dt>
            <dd style="margin-left: 1.5em" id="section-12.5.1-1.4">
              <p id="section-12.5.1-1.4.1">Brief description of the metadata (e.g., "Resource identifier URL").<a href="#section-12.5.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.5.1-1.5">
<strong>Change Controller</strong>:</dt>
            <dd style="margin-left: 1.5em" id="section-12.5.1-1.6">
              <p id="section-12.5.1-1.6.1">For IETF Stream RFCs, list "IETF". For others, give the name of the responsible party. Other details (e.g., postal address, email address, home page URI) may also be included.<a href="#section-12.5.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-12.5.1-1.7">
<strong>Specification Document(s)</strong>:</dt>
            <dd style="margin-left: 1.5em" id="section-12.5.1-1.8">
              <p id="section-12.5.1-1.8.1">Reference to the document or documents that specify the parameter, preferably including URIs that can be used to retrieve copies of the documents. An indication of the relevant sections may also be included but is not required.<a href="#section-12.5.1-1.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="initial-registry-contents">
<section id="section-12.5.2">
          <h4 id="name-initial-registry-contents">
<a href="#section-12.5.2" class="section-number selfRef">12.5.2. </a><a href="#name-initial-registry-contents" class="section-name selfRef">Initial Registry Contents</a>
          </h4>
<p id="section-12.5.2-1"><strong>Resources:</strong><a href="#section-12.5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.5.2-2.1">
              <p id="section-12.5.2-2.1.1"><strong>Metadata Name</strong>: resources<a href="#section-12.5.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-2.2">
              <p id="section-12.5.2-2.2.1"><strong>Metadata Description</strong>: JSON array containing a list of target protected resources' resource identifier URLs<a href="#section-12.5.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-2.3">
              <p id="section-12.5.2-2.3.1"><strong>Change Controller</strong>: IETF<a href="#section-12.5.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-2.4">
              <p id="section-12.5.2-2.4.1"><strong>Specification Document(s)</strong>: [this document]<a href="#section-12.5.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-12.5.2-3"><strong>Authorization Servers:</strong><a href="#section-12.5.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.5.2-4.1">
              <p id="section-12.5.2-4.1.1"><strong>Metadata Name</strong>: authorization_servers<a href="#section-12.5.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-4.2">
              <p id="section-12.5.2-4.2.1"><strong>Metadata Description</strong>: JSON array containing a list of authorization server issuer identifiers<a href="#section-12.5.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-4.3">
              <p id="section-12.5.2-4.3.1"><strong>Change Controller</strong>: IETF<a href="#section-12.5.2-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-4.4">
              <p id="section-12.5.2-4.4.1"><strong>Specification Document(s)</strong>: [this document]<a href="#section-12.5.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-12.5.2-5"><strong>Supported Permissions:</strong><a href="#section-12.5.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.5.2-6.1">
              <p id="section-12.5.2-6.1.1"><strong>Metadata Name</strong>: permissions_supported<a href="#section-12.5.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-6.2">
              <p id="section-12.5.2-6.2.1"><strong>Metadata Description</strong>: JSON object indicating the permissions the delegated party may request<a href="#section-12.5.2-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-6.3">
              <p id="section-12.5.2-6.3.1"><strong>Change Controller</strong>: IETF<a href="#section-12.5.2-6.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-6.4">
              <p id="section-12.5.2-6.4.1"><strong>Specification Document(s)</strong>: [this document]<a href="#section-12.5.2-6.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-12.5.2-7"><strong>API Permissions:</strong><a href="#section-12.5.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.5.2-8.1">
              <p id="section-12.5.2-8.1.1"><strong>Metadata Name</strong>: api_permissions<a href="#section-12.5.2-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-8.2">
              <p id="section-12.5.2-8.2.1"><strong>Metadata Description</strong>: JSON object mapping API endpoints (resource identifiers) to the permissions required to access them<a href="#section-12.5.2-8.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-8.3">
              <p id="section-12.5.2-8.3.1"><strong>Change Controller</strong>: IETF<a href="#section-12.5.2-8.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-8.4">
              <p id="section-12.5.2-8.4.1"><strong>Specification Document(s)</strong>: [this document]<a href="#section-12.5.2-8.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-12.5.2-9"><strong>Delegated Party Documentation:</strong><a href="#section-12.5.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.5.2-10.1">
              <p id="section-12.5.2-10.1.1"><strong>Metadata Name</strong>: delegated_party_documentation<a href="#section-12.5.2-10.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-10.2">
              <p id="section-12.5.2-10.2.1"><strong>Metadata Description</strong>: URL of a page containing human-readable information that developers might want or need to know when using the delegated party<a href="#section-12.5.2-10.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-10.3">
              <p id="section-12.5.2-10.3.1"><strong>Change Controller</strong>: IETF<a href="#section-12.5.2-10.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-12.5.2-10.4">
              <p id="section-12.5.2-10.4.1"><strong>Specification Document(s)</strong>: [this document]<a href="#section-12.5.2-10.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6750">[RFC6750]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6750">https://www.rfc-editor.org/rfc/rfc6750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7516">[RFC7516]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7516">https://www.rfc-editor.org/rfc/rfc7516</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7636">[RFC7636]</dt>
        <dd>
<span class="refAuthor">Sakimura, N., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7636">https://www.rfc-editor.org/rfc/rfc7636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7662">[RFC7662]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refTitle">"OAuth 2.0 Token Introspection"</span>, <span class="seriesInfo">RFC 7662</span>, <span class="seriesInfo">DOI 10.17487/RFC7662</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7662">https://www.rfc-editor.org/rfc/rfc7662</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8414">https://www.rfc-editor.org/rfc/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8615">[RFC8615]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 8615</span>, <span class="seriesInfo">DOI 10.17487/RFC8615</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8615">https://www.rfc-editor.org/rfc/rfc8615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8705">[RFC8705]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">T. Lodderstedt</span>, <span class="refTitle">"OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens"</span>, <span class="seriesInfo">RFC 8705</span>, <span class="seriesInfo">DOI 10.17487/RFC8705</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8705">https://www.rfc-editor.org/rfc/rfc8705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9110">https://www.rfc-editor.org/rfc/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9396">[RFC9396]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Richer, J.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Rich Authorization Requests"</span>, <span class="seriesInfo">RFC 9396</span>, <span class="seriesInfo">DOI 10.17487/RFC9396</span>, <time datetime="2023-05" class="refDate">May 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9396">https://www.rfc-editor.org/rfc/rfc9396</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9449">[RFC9449]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">D. Waite</span>, <span class="refTitle">"OAuth 2.0 Demonstrating Proof of Possession (DPoP)"</span>, <span class="seriesInfo">RFC 9449</span>, <span class="seriesInfo">DOI 10.17487/RFC9449</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9449">https://www.rfc-editor.org/rfc/rfc9449</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9700">[RFC9700]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Labunets, A.</span>, and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"Best Current Practice for OAuth 2.0 Security"</span>, <span class="seriesInfo">BCP 240</span>, <span class="seriesInfo">RFC 9700</span>, <span class="seriesInfo">DOI 10.17487/RFC9700</span>, <time datetime="2025-01" class="refDate">January 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9700">https://www.rfc-editor.org/rfc/rfc9700</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9728">[RFC9728]</dt>
      <dd>
<span class="refAuthor">Jones, M.B.</span>, <span class="refAuthor">Hunt, P.</span>, and <span class="refAuthor">A. Parecki</span>, <span class="refTitle">"OAuth 2.0 Protected Resource Metadata"</span>, <span class="seriesInfo">RFC 9728</span>, <span class="seriesInfo">DOI 10.17487/RFC9728</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9728">https://www.rfc-editor.org/rfc/rfc9728</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC8792">[RFC8792]</dt>
      <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Auerswald, E.</span>, <span class="refAuthor">Farrel, A.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"Handling Long Lines in Content of Internet-Drafts and RFCs"</span>, <span class="seriesInfo">RFC 8792</span>, <span class="seriesInfo">DOI 10.17487/RFC8792</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8792">https://www.rfc-editor.org/rfc/rfc8792</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="token-format">
<section id="appendix-A">
      <h2 id="name-token-format">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-token-format" class="section-name selfRef">Token Format</a>
      </h2>
<p id="appendix-A-1">The example tokens in this section are shown in Flattened JSON Serialization <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>, un-base64url-encoded/unencrypted, and with comments for ease of reading. When used as JWTs <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>, they should be represented in Compact Serialization <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>. Similarly, they can be represented as CWTs <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="example-1">
<section id="appendix-A.1">
        <h3 id="name-example-1">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-example-1" class="section-name selfRef">Example 1</a>
        </h3>
<p id="appendix-A.1-1">In this example, the delegation token is a JWS token signed with HS256, and the delegated access token is a JWS token signed with RS256.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2"><strong>Delegation Token</strong>:<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<div class="lang-sourcecode sourcecode" id="appendix-A.1-3">
<pre>
{
  "protected": {
    "_comment": "to be base64url-encoded",
    "alg": "HS256",
    "typ": "JWT",
    "kid": "as-key-1"
  },
  "payload": {
    "_comment": "to be base64url-encoded",
    "iss": "https://as1.example.com",
    "sub": "user@example.com",
    "aud": "https://res1.example.com",
    "iat": 1760946495,
    "exp": 1763538495,
    "scope": "email:read email:send",
    "delegation_key": {
      "kty": "RSA",
      "n": "xoGV-drpIhwQ9Q3M5ouoA4Y76j4r0c2YcJoPT2qUd8UxV1PZH61TGZUbdUAdQLqi7Pik3GwTk34b6Xxb2-UkW3zoaBx_2FXXfVWwSVbfxi4RCbFP-rWGlbyYTRILj6CJM5JXI8VQdcSF8yfPZVytw-aKU-5k4RddKxgyMwkWNCShWPa_H2WRsDzcy88pE-8q1cg6hbaq5GTywdiSeGWrjMYebQqIN-V63bX2aiOHhFvPVpEoI7AlxlrQd7aJtFwfuRl-0FxJH-2ITrnHFZaFAdoJqvFSD3OKZNkECBpuDL-DHcZUZfEyr4Rvb3WB0iuHHfHXzhbzqAt3NbZalmdQNw",
      "e": "AQAB"
    }
  },
  "signature": "1gR7TSa8ft8Wt4ZA9HuLFTYW2uAw86X2pFRrq9jDoQQ"
}
</pre><a href="#appendix-A.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-4"><strong>Delegated Access Token</strong>:<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<div class="lang-sourcecode sourcecode" id="appendix-A.1-5">
<pre>
{
  "protected": {
    "_comment": "to be base64url-encoded",
    "alg": "RS256",
    "typ": "JWT",
    "kid": "delegation-key-1"
  },
  "payload": {
    "_comment": "to be base64url-encoded",
    "iss": "user@example.com",
    "sub": "https://dp1.example.com",
    "aud": "https://res1.example.com",
    "iat": 1760950095,
    "exp": 1760953695,
    "scope": "email:read",
    "delegationToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImFzLWtleS0xIn0.eyJpc3MiOiJodHRwczovL2FzMS5leGFtcGxlLmNvbSIsInN1YiI6InVzZXJAZXhhbXBsZS5jb20iLCJhdWQiOiJodHRwczovL3JlczEuZXhhbXBsZS5jb20iLCJpYXQiOjE3NjA5NDY0OTUsImV4cCI6MTc2MzUzODQ5NSwic2NvcGUiOiJlbWFpbDpyZWFkIGVtYWlsOnNlbmQiLCJkZWxlZ2F0aW9uX2tleSI6eyJrdHkiOiJSU0EiLCJuIjoieG9HVi1kcnBJaHdROVEzTTVvdW9BNFk3Nmo0cjBjMlljSm9QVDJxVWQ4VXhWMVBaSDYxVEdaVWJkVUFkUUxxaTdQaWszR3dUazM0YjZYeGIyLVVrVzN6b2FCeF8yRlhYZlZXd1NWYmZ4aTRSQ2JGUC1yV0dsYnlZVFJJTGo2Q0pNNUpYSThWUWRjU0Y4eWZQWlZ5dHctYUtVLTVrNFJkZEt4Z3lNd2tXTkNTaFdQYV9IMldSc0R6Y3k4OHBFLThxMWNnNmhiYXE1R1R5d2RpU2VHV3JqTVllYlFxSU4tVjYzYlgyYWlPSGhGdlBWcEVvSTdBbHhsclFkN2FKdEZ3ZnVSbC0wRnhKSC0ySVRybkhGWmFGQWRvSnF2RlNEM09LWk5rRUNCcHVETC1ESGNaVVpmRXlyNFJ2YjNXQjBpdUhIZkhYemhienFBdDNOYlphbG1kUU53IiwiZSI6IkFRQUIifX0.1gR7TSa8ft8Wt4ZA9HuLFTYW2uAw86X2pFRrq9jDoQQ"
  },
  "signature": "r5O4a3d3NMN7vZlOB9P4qPLbHyy12bZH5Ha3DZATa8NUdHYPJBMieiS1tqbhwfnTvwcSR_0Ac42dRHDrk8MWPkCl_9-bfYNvf9eGrcwSRn7889-pleH-QphxZG4Tsr8m2WlGM8VFnC9sjkhqGvmM9ZdC02GEaiptU9D859QU3-u-tvRdSgrHXeuLY2a3hgpWnj0j4gfgpug-VSvNB26vqCWwM4mwMGWYUPDabBaPp-KL38_M1T7q4wvFE0_KLvTSdozMe1ngkLewvSTBrnW1rULhXFk54j381wQ_ovaJhM1aAbWshb1AMzu-aiv0EZJjB1XlgORVh-KbId01TZQLwA"
}
</pre><a href="#appendix-A.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-2">
<section id="appendix-A.2">
        <h3 id="name-example-2">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-example-2" class="section-name selfRef">Example 2</a>
        </h3>
<p id="appendix-A.2-1">In this example, the delegation token is a JWE token encrypted with A128CBC-HS256, and the delegated access token is a JWS token signed with ES256.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2"><strong>Delegation Token</strong>:<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<div class="lang-sourcecode sourcecode" id="appendix-A.2-3">
<pre>
{
  "protected": {
    "_comment": "to be base64url-encoded",
    "alg": "dir",
    "enc": "A128CBC-HS256",
    "typ": "JWT",
    "kid": "as-key-2"
  },
  "iv": "s99tD84KH1_kgbA2ArpUZg",
  "ciphertext": {
    "_comment": "to be encrypted",
    "iss": "https://as1.example.com",
    "sub": "user@example.com",
    "aud": "https://res1.example.com",
    "iat": 1760946495,
    "exp": 1763538495,
    "scope": "email:read email:send",
    "delegation_key": {
      "kty": "EC",
      "crv": "P-256",
      "x": "iZgQ3t5EK4rVdkex6LAGfxB0deOHtE3-vb-OBxoFv88",
      "y": "RQVYHkEWrTR6jckD7iHXnRRs60-u9ikSfVnM4epiOLY"
    }
  },
  "tag": "9Z4ONkwLwv3szT-eIKa4uQ"
}
</pre><a href="#appendix-A.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-4"><strong>Delegated Access Token</strong>:<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<div class="lang-sourcecode sourcecode" id="appendix-A.2-5">
<pre>
{
  "protected": {
    "_comment": "to be base64url-encoded",
    "alg": "ES256",
    "typ": "JWT",
    "kid": "delegation-key-2"
  },
  "payload": {
    "_comment": "to be base64url-encoded",
    "iss": "user@example.com",
    "sub": "https://dp1.example.com",
    "aud": "https://res1.example.com",
    "iat": 1760950095,
    "exp": 1760953695,
    "scope": "email:read",
    "delegationToken": "eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2IiwidHlwIjoiSldUIiwia2lkIjoiYXMta2V5LTIifQ..s99tD84KH1_kgbA2ArpUZg.DS5aM1uuKpFFacu7rIvKOYnA-6BRPy6jyZ-3uF8bpplWJkCQmsAi8KqS-qTZuHWNfIWw7ulK-a8rWhfPPfLrgdXky6Ujc_3vm5YXRXmwxlaNJlhr2LexPXsTX2wA_3aIo9c0b5kQB2MHqeI5ucJDSdERCV2AaQTgl7vRmJhZ_FAY5cnd2URHEsqnm5usrywzGMLw5CnXg2MBl1jWxiHp-PmzOmRPHks4jFV2es2jjr-yB5PlX2d-OBCU2hauM_JjtnYOhByiXmAVVE6XKjJHXYM-d5q3JheTDg5gA4f1Io38_r2KA3pW07CF94Nx3i7VRxaFRSVYuNxlEhUx0vxOIlwRBa3_ZOK4Kkg-og66ADs73RuBg91cCthbr63NfIdEXmmYKG2Nx3DehojbVKZQrg.9Z4ONkwLwv3szT-eIKa4uQ"
  },
  "signature": "hlxIMOUb_Wdjh53VPcvuXBwTDiGzC7O8-ofV2LAvkws-LRIqKF6WRZ3KoPG1iTEDDhel3XXAGCyfRFCMXH3KiQ"
}
</pre><a href="#appendix-A.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="use-cases">
<section id="appendix-B">
      <h2 id="name-use-cases">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<div id="delegating-subset-of-access-rights-to-specialized-ai-agents">
<section id="appendix-B.1">
        <h3 id="name-delegating-subset-of-access">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-delegating-subset-of-access" class="section-name selfRef">Delegating Subset of Access Rights to Specialized AI Agents</a>
        </h3>
<p id="appendix-B.1-1">Enterprise Identity and Access Management systems often employ Role Based Access Control (RBAC) or Attribute Based Access Control (ABAC), assigning a set of minimal permissions to the employee based on its role, department, or other attributes. AI Agent can be an employee's personal assistant, or a virtual employee of a certain department in general. An Agent's delegated permissions CAN be long-termed, but <span class="bcp14">MUST NOT</span> be a direct inheritance of all its owner's access right. Rather, they <span class="bcp14">SHOULD</span> be a subset of its owner, bound to specfic service/API/database/codebase according to its specialty and dedicated workflow.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<span id="name-ai-agents"></span><table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-ai-agents" class="selfRef">AI Agents</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Role</th>
              <th class="text-left" rowspan="1" colspan="1">Service / Component</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Resource Owner</td>
              <td class="text-left" rowspan="1" colspan="1">an enterprise, individual or a department</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Client</td>
              <td class="text-left" rowspan="1" colspan="1">agent's client application</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Delegated Party</td>
              <td class="text-left" rowspan="1" colspan="1">CI-CD agent, test agent, DEV agent, research agent</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Authorization Server</td>
              <td class="text-left" rowspan="1" colspan="1">enterprise IAM system</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Resource Server</td>
              <td class="text-left" rowspan="1" colspan="1">enterprise IT systems</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Target Protected Resource</td>
              <td class="text-left" rowspan="1" colspan="1">DEV/STAGE/PROD environments, internal knowledge database</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="thirdparty-analytics-platform-integrated-in-an-enterprise-saas">
<section id="appendix-B.2">
        <h3 id="name-thirdparty-analytics-platfo">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-thirdparty-analytics-platfo" class="section-name selfRef">Third‑Party Analytics Platform Integrated in an Enterprise SaaS</a>
        </h3>
<p id="appendix-B.2-1">In this scenario, a corporate customer uses a Software-as-a-Service (SaaS) Customer Relationship Management (CRM) application. The customer wishes to gain business insights by granting a specialized third-party analytics platform limited access to its CRM data.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">The CRM application obtains a delegation token from the enterprise's identity provider. It then creates a narrowly scoped delegated access token for the analytics service. This token only permits read access to a predefined, non-sensitive subset of customer data (e.g., names and identifiers, but not personal email addresses). The analytics platform uses this token to pull data, generates an aggregated business intelligence report, and delivers it back to the CRM application for the corporate customer to view.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<span id="name-enterprise-saas"></span><table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-enterprise-saas" class="selfRef">Enterprise-SaaS</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Role</th>
              <th class="text-left" rowspan="1" colspan="1">Service / Component</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Resource Owner</td>
              <td class="text-left" rowspan="1" colspan="1">company A (the tenant)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Client</td>
              <td class="text-left" rowspan="1" colspan="1">SaaS CRM application</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Delegated Party</td>
              <td class="text-left" rowspan="1" colspan="1">analytics service</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Authorization Server</td>
              <td class="text-left" rowspan="1" colspan="1">enterprise IdP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Resource Server</td>
              <td class="text-left" rowspan="1" colspan="1">CRM application server</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Target Protected Resource</td>
              <td class="text-left" rowspan="1" colspan="1">CRM application's data retrieval API</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ruochen Li</span></div>
<div dir="auto" class="left"><span class="org">Huawei Int. Pte Ltd</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:li.ruochen@h-partners.com" class="email">li.ruochen@h-partners.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Haiguang Wang</span></div>
<div dir="auto" class="left"><span class="org">Huawei Int. Pte Ltd</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wang.haiguang.shieldlab@huawei.com" class="email">wang.haiguang.shieldlab@huawei.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chunchi Peter Liu</span></div>
<div dir="auto" class="left"><span class="org">Huawei Technologies</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:liuchunchi@huawei.com" class="email">liuchunchi@huawei.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tieyan Li</span></div>
<div dir="auto" class="left"><span class="org">Huawei Int. Pte Ltd</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Li.Tieyan@huawei.com" class="email">Li.Tieyan@huawei.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
